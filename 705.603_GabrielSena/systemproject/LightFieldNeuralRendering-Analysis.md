# Light Field Neural Rendering (LFNR)
### About
LFNR is a  two-stage transformer-based model that first aggregates features along 
epipolar lines, then aggregates features along reference views to produce the color 
of a target ray. [LFNR2021] LFNR is able to also reproduce challenging effects like
refletions, refractions, and translucency.

_LFNR Github Project found [here](https://github.com/google-research/google-research/tree/master/light_field_neural_rendering)._

### Successes
Libraries are compatible (to an extent) on Apple M1 and Ubuntu.
### Failures
##### Limitation 1: LFNR on Apple M1
When processing on Apple m1 GPU's we encounter a few compatibility issues that arise during processing. 
Specially, support for Jax method calls are not fully functional.

Github Issues I have raised:
1. [[JAX + IREE] - failed to legalize operation 'mhlo.triangular_solve' #11018](https://github.com/iree-org/iree/issues/11018): OPEN
2. [[JAX + IREE | Apple M1 Max] - Fails to legalize 'math.roundeven' #10938
](https://github.com/iree-org/iree/issues/10938): CLOSED

Both issues above deal with trying to process using the Jax library and ultimately leads into a rabbit 
hole of figuring out which Jax methods work and which don't. As I have spend quite a bit of time 
tracking down these issues and testing locally I have decided to abandon this approach for the time being.

#### Example Output:
Althought we made some progress the error displayed at the bottom is related to the github issues mentioned above 
in the limitations section. Once there is support for jax/iree on m1 I am confident this model will train correctly.
```
Users/lausena/miniforge3/envs/tfpy310/bin/python /Users/lausena/developer/repos/light_field_neural_rendering/main.py --workdir=/tmp/toy_task --is_train=True --ml_config=configs/defaults.py --ml_config.dataset.base_dir=/Users/lausena/developer/repos/light_field_neural_rendering/scenes/ --ml_config.dataset.scene=crest --ml_config.dataset.batch_size=16 --ml_config.model.num_projections=64 --ml_config.train.lr_init=3.0e-5 --ml_config.train.warmup_steps=5000 --ml_config.train.render_every_steps=500000 --ml_config.model.transformer_layers=4 --ml_config.model.conv_feature_dim=(8,) --ml_config.eval.chunk=4096 --ml_config.model.ksize1=5 
I1207 18:43:01.709175 8769070336 main.py:57] JAX process: 0 / 1
I1207 18:43:01.709251 8769070336 main.py:58] JAX devices: [<jax._src.iree.IreeDevice object at 0x2a55f0850>]
I1207 18:43:01.709388 8769070336 local.py:45] Setting task status: process_index: 0, process_count: 1
I1207 18:43:01.709450 8769070336 local.py:50] Created artifact workdir of type ArtifactType.DIRECTORY and value /tmp/toy_task.
I1207 18:43:01.765470 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.528105 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.563807 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.603363 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.661203 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.735482 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.897891 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:43:03.970581 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/lib/xla_bridge.py:553: UserWarning: jax.host_count has been renamed to jax.process_count. This alias will eventually be removed; please update your code.
  warnings.warn(
100%|██████████| 40/40 [00:12<00:00,  3.22it/s]
I1207 18:45:14.967029 8769070336 train_lib.py:210] num_train_steps=250000, steps_per_epoch=1388
I1207 18:45:15.047276 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.287995 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.349510 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.404751 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.456591 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.493945 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.551573 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.606838 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.657202 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.714757 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.812135 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:15.972787 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.022610 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.080302 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.116977 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.172307 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.229049 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.263769 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.316902 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.371119 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.430304 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.465301 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.502519 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.538795 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.610344 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.687588 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.743162 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.793473 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.825598 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.879518 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.934880 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:16.991070 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.046318 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.102934 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.160826 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.214490 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.267318 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.320987 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.356776 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.414345 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.467642 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.522661 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.577805 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.636900 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.693248 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.752585 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.821765 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.880011 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.931911 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:17.989338 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:18.043950 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
I1207 18:45:18.196247 8769070336 binaries.py:182] Invoke IREE Tool: /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false
Traceback (most recent call last):
  File "/Users/lausena/developer/repos/light_field_neural_rendering/main.py", line 77, in <module>
    app.run(main)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/Users/lausena/developer/repos/light_field_neural_rendering/main.py", line 69, in main
    train_lib.train_and_evaluate(FLAGS.ml_config, FLAGS.workdir)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/train_lib.py", line 218, in train_and_evaluate
    model, state = models.create_train_state(
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/__init__.py", line 78, in create_train_state
    model, variables = create_model(config, rng, example_batch)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/__init__.py", line 49, in create_model
    model, variables = model_dict[config.model.name](key0, example_batch, config)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/lfnr.py", line 399, in construct_model
    init_variables = model.init(  # pylint: disable=no-member
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/linen/module.py", line 1333, in init
    _, v_out = self.init_with_output(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/linen/module.py", line 1289, in init_with_output
    return init_with_output(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/core/scope.py", line 897, in wrapper
    return apply(fn, mutable=mutable, flags=init_flags)({}, *args, rngs=rngs,
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/core/scope.py", line 865, in wrapper
    y = fn(root, *args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/linen/module.py", line 1750, in scope_fn
    return fn(module.clone(parent=scope), *args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/linen/module.py", line 402, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/flax/linen/module.py", line 705, in _call_wrapped_method
    y = fun(self, *args, **kwargs)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/lfnr.py", line 297, in __call__
    projected_rays = self.projector.get_near_rays(
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py", line 214, in get_near_rays
    inverse_intrisics = jnp.linalg.inv(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/api.py", line 620, in cache_miss
    execute = dispatch._xla_call_impl_lazy(fun_, *tracers, **params)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 236, in _xla_call_impl_lazy
    return xla_callable(fun, device, backend, name, donated_invars, keep_unused,
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/linear_util.py", line 300, in memoized_fun
    ans = call(fun, *args)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 360, in _xla_callable_uncached
    keep_unused, *arg_specs).compile().unsafe_call
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 996, in compile
    self._executable = XlaCompiledComputation.from_xla_computation(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 1194, in from_xla_computation
    compiled = compile_or_get_cached(backend, xla_computation, options,
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 1077, in compile_or_get_cached
    return backend_compile(backend, serialized_computation, compile_options,
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/profiler.py", line 314, in wrapper
    return func(*args, **kwargs)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/dispatch.py", line 1012, in backend_compile
    return backend.compile(built_c, compile_options=options)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/iree.py", line 186, in compile
    iree_binary = iree.compiler.compile_str(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/core.py", line 278, in compile_str
    result = invoke_immediate(cl, immediate_input=input_bytes)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/binaries.py", line 196, in invoke_immediate
    raise CompilerToolError(process)
jax._src.traceback_util.UnfilteredStackTrace: iree.compiler.tools.binaries.CompilerToolError: Error invoking IREE compiler tool iree-compile
Diagnostics:
/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py:212:0: error: failed to legalize operation 'mhlo.triangular_solve' that was explicitly marked illegal
/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py:212:0: note: called from
compilation failed


Invoked with:
 iree-compile /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false

Need more information? Set IREE_SAVE_TEMPS=/some/dir in your environment to save all artifacts and reproducers.

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lausena/developer/repos/light_field_neural_rendering/main.py", line 77, in <module>
    app.run(main)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/Users/lausena/developer/repos/light_field_neural_rendering/main.py", line 69, in main
    train_lib.train_and_evaluate(FLAGS.ml_config, FLAGS.workdir)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/train_lib.py", line 218, in train_and_evaluate
    model, state = models.create_train_state(
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/__init__.py", line 78, in create_train_state
    model, variables = create_model(config, rng, example_batch)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/__init__.py", line 49, in create_model
    model, variables = model_dict[config.model.name](key0, example_batch, config)
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/lfnr.py", line 399, in construct_model
    init_variables = model.init(  # pylint: disable=no-member
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/lfnr.py", line 297, in __call__
    projected_rays = self.projector.get_near_rays(
  File "/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py", line 214, in get_near_rays
    inverse_intrisics = jnp.linalg.inv(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/jax/_src/iree.py", line 186, in compile
    iree_binary = iree.compiler.compile_str(
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/core.py", line 278, in compile_str
    result = invoke_immediate(cl, immediate_input=input_bytes)
  File "/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/binaries.py", line 196, in invoke_immediate
    raise CompilerToolError(process)
iree.compiler.tools.binaries.CompilerToolError: Error invoking IREE compiler tool iree-compile
Diagnostics:
/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py:212:0: error: failed to legalize operation 'mhlo.triangular_solve' that was explicitly marked illegal
/Users/lausena/developer/repos/light_field_neural_rendering/src/models/projector.py:212:0: note: called from
compilation failed


Invoked with:
 iree-compile /Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-compile - --iree-input-type=mhlo --iree-vm-bytecode-module-output-format=flatbuffer-binary --iree-hal-target-backends=vulkan-spirv --iree-llvm-embedded-linker-path=/Users/lausena/miniforge3/envs/tfpy310/lib/python3.10/site-packages/iree/compiler/tools/../_mlir_libs/iree-lld --mlir-print-debuginfo --mlir-print-op-on-diagnostic=false --iree-llvm-target-triple=arm64-apple-darwin22.1.0 --iree-flow-demote-i64-to-i32 --iree-vulkan-target-triple=m1-moltenvk-macos --iree-llvm-target-cpu-features=host --iree-mhlo-demote-i64-to-i32=false

Need more information? Set IREE_SAVE_TEMPS=/some/dir in your environment to save all artifacts and reproducers.
```


### Citations
```
@misc{LFNR2021,
  doi = {10.48550/ARXIV.2112.09687},
  url = {https://arxiv.org/abs/2112.09687},
  author = {Suhail, Mohammed and Esteves, Carlos and Sigal, Leonid and Makadia, Ameesh},
  keywords = {Computer Vision and Pattern Recognition (cs.CV), FOS: Computer and information sciences, FOS: Computer and information sciences},
  title = {Light Field Neural Rendering},
  publisher = {arXiv},
  year = {2021},  
  copyright = {Creative Commons Attribution 4.0 International}
}
```